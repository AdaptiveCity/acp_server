<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>

<head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <script src="//cdn.jsdelivr.net/sockjs/1.0.3/sockjs.min.js"></script>
    <script src='vertx-eventbus.js'></script>
    <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<title>TFC ZONE 0.1</title>
<!--
RELEASE INFO:
2016-04-24 0.1 initial draft based on rita.html

-->	
<style type="text/css">
body {
   font-family: Tahoma, Verdana, Segoe, sans-serif;
}  

img {
   vertical-align: middle;
}

.chart {
    width: 600px;
    height: 350px;
}

</style>

<!-- RITA core -->
<script type="text/javascript">
//debug - should be provided by server
var CONSOLE_EVENTBUS_HTTP = 'http://carrier.csi.cam.ac.uk:8082/eb';

function rita_init()
{
    // initialize eventbus to connect to Rita.java on server
    eb = new EventBus(CONSOLE_EVENTBUS_HTTP);

    // script to run when Vertx EventBus is ready
    eb.onopen = function() {

        // set a handler to receive a "rita_out" message
        eb.registerHandler('rita_out', function(error, message) {
          write_console1('rita_out: ' + message.body + '<br/>');
        });

    }
}

</script>

<!-- Zone -->
<script type="text/javascript">

var zone_id;
  
function init()
{
    
    zone_id = "cam_test";
  
//    alert("init");
  
    rita_init();

    draw_chart();
}

function draw_chart()
{
    //Width and height
    var w = 500;
    var h = 100;

    var dataset = [
        [5, 20], [480, 90], [250, 50], [100, 33], [330, 95],
        [410, 12], [475, 44], [25, 67], [85, 21], [220, 88]
      ];

    //Create SVG element
    var svg = d3.select("#chart")
    .append("svg")
    .attr("width", w)
    .attr("height", h);

    svg.selectAll("circle")
       .data(dataset)
       .enter()
       .append("circle")
       .attr("cx", function(d) {
    return d[0];
       })
       .attr("cy", function(d) {
    return d[1];
       })
       .attr("r", 5);
}

function write_console1(msg)
{
    var c = document.getElementById('console1');
    c.innerHTML += msg;
}

</script>

</head>

<body onload='init()'>
  
  <h1><img src="images/smart_cambridge_logo.jpg">RITA Zone <span id='heading'></span></h1>
<div id="status">Initializing...</div>
  
<button onclick="debug()">DEBUG</button>

<div class="chart" id="chart">
</div>

<div id="console1">
		<h4>Messages</h4>
</div>
</body>
</html>
